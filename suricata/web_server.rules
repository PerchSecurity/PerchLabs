alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Possible Apache Struts 2 Forced OGNL Eval RCE Inbound (CVE-2020-17530)"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"|2e|InstanceManager"; nocase; content:"|2e|ValueStack"; distance:0; nocase; content:"|2e|BeanMap"; distance:0; nocase; content:"|2e|HashSet"; distance:0; nocase; content:"|2e|add|28|"; distance:0; nocase; content:"|2e|exec|28|"; distance:0; nocase; reference:url,https://github.com/wuzuowei/CVE-2020-17530; reference:cve,2020-17530; classtype:web-application-attack; sid:900219; rev:1;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Potential Joomla ACL Handler Privilege Escalation CVE-2020-35616"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"administrator/index.php?option="; nocase; http.request_body; pcre:"/&jform\[rules\]\[core\.(create|delete|edit)\]\[\d+\]=1/"; tag:session,5,packets; reference:url, https://blog.securelayer7.net/latest-joomla-exploit-cve-2020-35616-acl-security-vulnerabilities/; reference:cve, 2020-35616; classtype:web-application-attack; metadata:created_at 2020_12_30, updated_at 2020_12_30; sid:900222; rev:1;)

alert http any any -> any any (msg:"[Perch Security] Possible VMware vCenter Unauthenticated Arbitrary File Read"; flow:established, to_server; http.method; content:"GET"; http.uri; pcre:"/\/eam\/vibd?\?id=/"; tag:session,5,packets; reference:url, https://github.com/jas502n/Vmware_vCenter; classtype:web-application-attack; sid:900223; rev:1; metadata:created_at 2021_01_05, updated_at 2021_01_05;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Possible Sharepoint Remote Code Execution CVE-2020-0646"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/_vti_bin/webpartpages.asmx"; nocase; http.host; content:".sharepoint.com"; http.request_body; content:"CallExternalMethodActivity|20|x|3a|Name|3d|"; nocase; content:"System|2e|Diagnostics|2e|Process|2e|Start|28 22|"; distance:0; nocase; tag:session,5,packets; reference:cve, 2020-0646; reference:url, https://www.mdsec.co.uk/2020/01/code-injection-in-workflows-leading-to-sharepoint-rce-cve-2020-0646/sid:900224; rev:1; metadata:created_at 2021_01_05, updated_at 2021_01_05;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Possible Apache Flink Directory Traversal (CVE-2020-17519)"; flow:established, to_server; http.method; content:"GET"; http.uri.raw; content:"/jobmanager/logs/..%252F..%252F"; nocase; fast_pattern; tag:session,5,packets; reference:url, https://github.com/B1anda0/CVE-2020-17519/blob/main/CVE-2020-17519.py; reference:cve, 2020-17519; classtype:attempted-admin; sid:900225; rev:1; metadata:created_at 2021_01_06, updated_at 2021_01_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Possible Apache Flink Upload Path Traversal (CVE-2020-17518)"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/jars/upload"; nocase; fast_pattern; tag:session,5,packets; reference:url, https://github.com/vulhub/vulhub/tree/c339f4ddd977ff9a956350de4b1e6fb20b7b4415/flink/CVE-2020-17518; reference:cve, 2020-17518; classtype:web-application-attack; sid:900226; rev:1; metadata:created_at 2021_01_06, updated_at 2021_01_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Zend PHP Framework3 RCE (CVE-2021-3007)"; flow:established, to_server; http.method; content:"POST"; http.request_body; content:"WmVuZFxIdHRwXFJlc3BvbnNlXFN0cmVhbS"; content:"lplbmRcVmlld1xIZWxwZXJcR3JhdmF0YXI"; distance:0; content:"WmVuZFxWaWV3XFJlbmRlcmVyXFBocFJlbmRlcmVy"; distance:0; pcre:"/(?:FxDb25maWdcUmVhZGVyUGx1Z2luTWFuYWdlci|FxDb25maWdcQ29uZmln).+(?:JaZW5kXFZhbGlkYXRvclxDYWxsYmFjay|WmVuZFxWYWxpZGF0b3JcQ2FsbGJhY2s)/R"; tag:session,5,packets; classtype:web-application-attack; reference: url, github.com/Ling-Yizhou/zendframework3-; sid:900229; rev:1; metadata:created_at 2021_01_08, updated_at 2021_01_08, cve, CVE-2021-3007;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Potential Atlassian Jira Server/Data Center Unauthenticated Information Exposure (CVE-2020-14179)"; flow:established, to_server; http.method; content:"GET"; http.uri; content:"/secure/QueryComponent!Default.jspa"; fast_pattern; tag:session,5,packets; classtype:web-application-attack; sid:900232; rev:1; metadata:created_at 2021_01_08, updated_at 2021_01_08;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Potential SAP EEM RCE (CVE-2020-6207)"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/EemAdminService/EemAdmin"; http.request_body; pcre:"/:(?:getAgentInfo|getAllAgentInfo|setAgeletProperties|uploadResource|stopScript|deleteScript|setServerName).+(ProcessBuilder|getRuntime)?/i"; tag:session,5,packets; reference:url, github.com/chipik/SAP_EEM_CVE-2020-6207; sid:900233; rev:1; metadata: created_at 2021_01_15, updated_at 2021_01_15, cve CVE-2020-6207;)

alert http any any -> $HOME_NET any (msg:"[Perch Security] Potential Nagios XI 5.7.x Authenticated RCE"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/nagiosxi/admin/monitoringplugins.php"; http.request_body; content:"uploadedfile"; tag:session,5,packets; reference:url, https://www.exploit-db.com/exploits/49422; classtype:web-application-attack; sid:900234; rev:1; metadata: created_at 2021_01_17, updated_at 2021_01_17;)

alert http any any -> $HOME_NET any (msg:"[Perch Security] Potential Oracle Weblogic RCE (CVE-2021-2109)"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/consolejndi.portal?"; http.request_body; content:"JNDIBindingPageGeneral"; distance:0; nocase; content:"JndiBindingHandle"; distance:0; nocase; content:"|3b|AdminServer"; distance:0; nocase; tag:session,5,packets; reference:url, twitter.com/jas502n/status/1352076921190850563; classtype:web-application-attack; sid:900235; rev:1; metadata: created_at 2021_01_21 updated_at 2021_01_21, cve CVE-2021-2109;)

alert http any any -> $HOME_NET any (msg:"[Perch Security] Potential Apache Druid Remote Code Execution (CVE-2021-25646)"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/druid/"; http.request_body; content:"dataSchema"; content:"transformSpec"; distance:0; content:"javascript"; distance:0; nocase; content:"function("; distance:0; nocase; reference:url, https://gist.github.com/FanqXu/36c5e0070fd8e0b6646993b4e386a6b1; classtype:web-application-attack; sid:900236; rev:1; metadata: created_at 2021_02_02, updated_at 2021_02_02, cve CVE-2021-25646;)
