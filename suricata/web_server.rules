alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Possible Apache Struts 2 Forced OGNL Eval RCE Inbound (CVE-2020-17530)"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"|2e|InstanceManager"; nocase; content:"|2e|ValueStack"; distance:0; nocase; content:"|2e|BeanMap"; distance:0; nocase; content:"|2e|HashSet"; distance:0; nocase; content:"|2e|add|28|"; distance:0; nocase; content:"|2e|exec|28|"; distance:0; nocase; reference:url,https://github.com/wuzuowei/CVE-2020-17530; reference:cve,2020-17530; classtype:web-application-attack; sid:900219; rev:1;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Potential Joomla ACL Handler Privilege Escalation CVE-2020-35616"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"administrator/index.php?option="; nocase; http.request_body; pcre:"/&jform\[rules\]\[core\.(create|delete|edit)\]\[\d+\]=1/"; tag:session,5,packets; reference:url, https://blog.securelayer7.net/latest-joomla-exploit-cve-2020-35616-acl-security-vulnerabilities/; reference:cve, 2020-35616; classtype:web-application-attack; metadata:created_at 2020_12_30, updated_at 2020_12_30; sid:900222; rev:1;)

alert http any any -> any any (msg:"[Perch Security] Possible VMware vCenter Unauthenticated Arbitrary File Read"; flow:established, to_server; http.method; content:"GET"; http.uri; pcre:"/\/eam\/vibd?\?id=/"; tag:session,5,packets; reference:url, https://github.com/jas502n/Vmware_vCenter; classtype:web-application-attack; sid:900223; rev:1; metadata:created_at 2021_01_05, updated_at 2021_01_05;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Possible Sharepoint Remote Code Execution CVE-2020-0646"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/_vti_bin/webpartpages.asmx"; nocase; http.host; content:".sharepoint.com"; http.request_body; content:"CallExternalMethodActivity|20|x|3a|Name|3d|"; nocase; content:"System|2e|Diagnostics|2e|Process|2e|Start|28 22|"; distance:0; nocase; tag:session,5,packets; reference:cve, 2020-0646; reference:url, https://www.mdsec.co.uk/2020/01/code-injection-in-workflows-leading-to-sharepoint-rce-cve-2020-0646/sid:900224; rev:1; metadata:created_at 2021_01_05, updated_at 2021_01_05;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Possible Apache Flink Directory Traversal (CVE-2020-17519)"; flow:established, to_server; http.method; content:"GET"; http.uri.raw; content:"/jobmanager/logs/..%252F..%252F"; nocase; fast_pattern; tag:session,5,packets; reference:url, https://github.com/B1anda0/CVE-2020-17519/blob/main/CVE-2020-17519.py; reference:cve, 2020-17519; classtype:attempted-admin; sid:900225; rev:1; metadata:created_at 2021_01_06, updated_at 2021_01_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Possible Apache Flink Upload Path Traversal (CVE-2020-17518)"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/jars/upload"; nocase; fast_pattern; tag:session,5,packets; reference:url, https://github.com/vulhub/vulhub/tree/c339f4ddd977ff9a956350de4b1e6fb20b7b4415/flink/CVE-2020-17518; reference:cve, 2020-17518; classtype:web-application-attack; sid:900226; rev:1; metadata:created_at 2021_01_06, updated_at 2021_01_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Zend PHP Framework3 RCE (CVE-2021-3007)"; flow:established, to_server; http.method; content:"POST"; http.request_body; content:"WmVuZFxIdHRwXFJlc3BvbnNlXFN0cmVhbS"; content:"lplbmRcVmlld1xIZWxwZXJcR3JhdmF0YXI"; distance:0; content:"WmVuZFxWaWV3XFJlbmRlcmVyXFBocFJlbmRlcmVy"; distance:0; pcre:"/(?:FxDb25maWdcUmVhZGVyUGx1Z2luTWFuYWdlci|FxDb25maWdcQ29uZmln).+(?:JaZW5kXFZhbGlkYXRvclxDYWxsYmFjay|WmVuZFxWYWxpZGF0b3JcQ2FsbGJhY2s)/R"; tag:session,5,packets; classtype:web-application-attack; reference: url, github.com/Ling-Yizhou/zendframework3-; sid:900229; rev:1; metadata:created_at 2021_01_08, updated_at 2021_01_08, cve, CVE-2021-3007;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Potential Atlassian Jira Server/Data Center Unauthenticated Information Exposure (CVE-2020-14179)"; flow:established, to_server; http.method; content:"GET"; http.uri; content:"/secure/QueryComponent!Default.jspa"; fast_pattern; tag:session,5,packets; classtype:web-application-attack; sid:900232; rev:1; metadata:created_at 2021_01_08, updated_at 2021_01_08;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[Perch Security] Potential SAP EEM RCE (CVE-2020-6207)"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/EemAdminService/EemAdmin"; http.request_body; pcre:"/:(?:getAgentInfo|getAllAgentInfo|setAgeletProperties|uploadResource|stopScript|deleteScript|setServerName).+(ProcessBuilder|getRuntime)?/i"; tag:session,5,packets; reference:url, github.com/chipik/SAP_EEM_CVE-2020-6207; sid:900233; rev:1; metadata: created_at 2021_01_15, updated_at 2021_01_15, cve CVE-2020-6207;)

alert http any any -> $HOME_NET any (msg:"[Perch Security] Potential Nagios XI 5.7.x Authenticated RCE"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/nagiosxi/admin/monitoringplugins.php"; http.request_body; content:"uploadedfile"; tag:session,5,packets; reference:url, https://www.exploit-db.com/exploits/49422; classtype:web-application-attack; sid:900234; rev:1; metadata: created_at 2021_01_17, updated_at 2021_01_17;)

alert http any any -> $HOME_NET any (msg:"[Perch Security] Potential Oracle Weblogic RCE (CVE-2021-2109)"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/consolejndi.portal?"; http.request_body; content:"JNDIBindingPageGeneral"; distance:0; nocase; content:"JndiBindingHandle"; distance:0; nocase; content:"|3b|AdminServer"; distance:0; nocase; tag:session,5,packets; reference:url, twitter.com/jas502n/status/1352076921190850563; classtype:web-application-attack; sid:900235; rev:1; metadata: created_at 2021_01_21 updated_at 2021_01_21, cve CVE-2021-2109;)

alert http any any -> $HOME_NET any (msg:"[Perch Security] Potential Apache Druid Remote Code Execution (CVE-2021-25646)"; flow:established, to_server; http.method; content:"POST"; http.uri; content:"/druid/"; http.request_body; content:"dataSchema"; content:"transformSpec"; distance:0; content:"javascript"; distance:0; nocase; content:"function("; distance:0; nocase; reference:url, https://gist.github.com/FanqXu/36c5e0070fd8e0b6646993b4e386a6b1; classtype:web-application-attack; sid:900236; rev:1; metadata: created_at 2021_02_02, updated_at 2021_02_02, cve CVE-2021-25646;)

alert http any any -> $HOME_NET any (msg:"[Perch Security] Potential Adobe Magento Commerce Reflected Cross-Site Scripting (XSS) (CVE-2021-21029)"; flow:established, to_server; http.method; content:"GET"; http.uri; pcre:"/\/admin\/system_design_theme\/downloadCss\/theme_id\/\d+\/file\/[a-zA-Z0-9%]+\/(key\/)?/"; reference:url, packetstormsecurity.com/files/161364/SA-20210210-0.txt; classtype:web-application-attack; sid:900238; rev:1; metadata: created_at 2021_02_12, updated_at 2021_02_12, cve CVE_2021_21029;)

# terramaster CVE-2020-15568
alert http any any -> $HOME_NET 5443 (msg:"[Perch Security] Potential TerraMaster OS Command Injection (CVE-2020-15568)"; flow:established, to_server; http.method; content:"GET"; http.uri; content:"/include/exportUser.php?"; content:"type=3"; content:"cla=application"; content:"func=_exec"; content:"opt=("; reference:url, gist.github.com/pikpikcu/a7fcbc77ed2a7f45462d10420b1e68a9; classtype:web-application-attack; sid:900239; rev:1; metadata: created_at 2021_02_19, updated_at 2021_02_19, cve CVE_2020_15568;)

# vmware CVE-2021-21972
alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"VMware vSphere Client Exploit Attempt (CVE-2021-21972)"; flow:established,to_server; content:"/ui/vropspluginui/rest/services/uploadova"; fast_pattern; http_uri; content:"POST"; http_method; reference:url,https://www.vmware.com/security/advisories/VMSA-2021-0002.html; reference:cve,2021-21972; classtype:web-application-attack; sid: 900261; metadata:created_at 2021_02_24, cve CVE_2021_21972, signature_severity Critical, updated_at 2021_02_24;)

# nagios ix CVE-2021-25299, CVE-2021-25298, CVE-2021-25297, CVE-2021-25296
alert http any any -> $HOME_NET any (msg:"[Perch Security] Nagios IX Command Injection (CVE-2021-25296)"; flow:established, to_server; http.method; content:"GET"; http.uri; content:"/nagiosxi/config/monitoringwizard.php?"; pcre:"/plugin_output_len=\d+\;/Ui"; tag:session,5,packets; reference:url, packetstormsecurity.com/files/161561/nagiosxi575-exec.txt; classtype:web-application-attack; sid:900262; rev:1; metadata: created_at 02_26_2021, updated_at 02_26_2021, cve CVE_2021_25296;)
alert http any any -> $HOME_NET any (msg:"[Perch Security] Nagios IX Command Injection (CVE-2021-25297 & CVE-2021-25298)"; flow:established, to_server; http.method; content:"GET"; http.uri; content:"/nagiosxi/config/monitoringwizard.php?"; content:"ip_address="; content:"|3b|"; within:16; tag:session,5,packets; reference:url, packetstormsecurity.com/files/161561/nagiosxi575-exec.txt; classtype:web-application-attack; sid:900263; rev:1; metadata: created_at 02_26_2021, updated_at 02_26_2021, cve CVE_2021_25297, cve CVE_2021_25297;)
alert http any any -> $HOME_NET any (msg:"[Perch Security] Nagios IX Command Injection (CVE-2021-25299)"; flow:established, to_server; http.method; content:"GET"; http.uri; content:"/nagiosxi/admin/sshterm.php?"; content:"url="; nocase; pcre:"/url\x3d.+?(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange|style\x3D)/Ri"; tag:session,5,packets; reference:url, packetstormsecurity.com/files/161561/nagiosxi575-exec.txt; classtype:web-application-attack; sid:900264; rev:1; metadata: created_at 02_26_2021, updated_at 02_26_2021, cve CVE_2021_25299;)

# Node.JS CVE-2021-21315
alert http any any -> $HOME_NET any (msg:"[Perch Security] Node.JS <5.3.1 Potential OS Command Injection (CVE-2021-21315)"; flow:established, to_server; http.method; content:"GET"; http.uri; content:"/api/getServices?name|5b 5d|="; tag:session,5,packets; reference:url, github.com/ForbiddenProgrammer/CVE-2021-21315-PoC; classtype:web-application-attack; sid:900266; rev:1; metadata: created_at 2021_03_01, updated_at 2021_03_01, cve CVE_2021_21315;)

# vmware ssrf CVE-2021-21973
alert http any any -> $HOME_NET any (msg:"[Perch Security] VMWare vSphere Client Server-Side Request Forgery (CVE-2021-21973)"; flow:established, to_server; http.method; content:"GET"; http.uri; content:"/ui/vropspluginui/rest/services/getvcdetails"; http.header; content:"vcIP|3a|"; tag:session,5,packets; reference:url, twitter.com/osama_hroot/status/1365586206982082560; classtype:web-application-attack; sid:900267; rev:1; metadata: created_at 2021_03_02, updated_at 2021_03_02, cve CVE_2021_211973;)

# saltstack CVE-2021-25281
alert http any any -> $HOME_NET any (msg:"[Perch Security] SaltStack <3002.5 SaltAPI Non eAuth wheel_async Access (CVE-2021-25281)"; http.method; content:"POST"; http.uri; content:"/run"; http.request_body; content:"\"eauth\": \"auto\""; content:"\"client\": \"wheel_async\""; content:"../"; distance:0; tag:session,5,packets; reference:url, github.com/Immersive-Labs-Sec/CVE-2021-25281; classtype:web-application-attack; sid:900268; rev:1; metadata: created_at 2021_03_02, updated_at 2021_03_02, cve CVE_2021_25281;)

# Exchange 2016 auth bypass & rce CVE-2021-26855
alert http any any -> $HOME_NET any (msg:"[Perch Security] Microsoft Exchange Authentication Bypass (CVE-2021-26855)"; http.method; content:"POST"; http.uri; pcre:"/\/owa\/auth\/Current\/themes\/resources\/[a-zA-Z0-9_-]+\.(css|gif|eot|ttf)/U"; tag:session,5,packets; reference:url, www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/; classtype:web-application-attack; sid:900269; rev:1; metadata: created_at 2021_03_02, updated_at 2021_03_02, cve CVE_2021_26855;)
alert http any any -> $HOME_NET any (msg:"[Perch Security] Microsoft Exchange Remote Code Execution (CVE-2021-26855)"; http.method; content:"POST"; http.uri; pcre:"/\/ecp\/(default\.flt|main.css|[a-z]\.js)/U"; tag:session,5,packets; reference:url, www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/; classtype:web-application-attack; sid:900270; rev:1; metadata: created_at 2021_03_02, updated_at 2021_03_02, cve CVE_2021_26855;)

